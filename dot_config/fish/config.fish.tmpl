set -x LANG en_US.UTF-8

# Generated for envman. Do not edit.
test -s "$HOME/.config/envman/load.fish"; and source "$HOME/.config/envman/load.fish"

{{ if eq .chezmoi.os "linux" }}
eval (/home/linuxbrew/.linuxbrew/bin/brew shellenv)
{{ end }}
# Source Private BW file
# A file without any values can be seen at ~/.config/fish/functions/no_load/bw.fish
source ~/.config/fish/functions/bw/bw.fish

# Source Aliases Folder
for file in ~/.config/fish/alias/*.fish
    source $file
end

for file in ~/.config/fish/functions/custom/*.fish
    source $file
end

starship init fish | source
set -x STARSHIP_CONFIG ~/.config/starship/starship.toml
set -x TALOSCONFIG ~/code/rafaribe/home-ops/infrastructure/talos/clusterconfig/talosconfig
# Completions

flux completion fish | source
#kubectl completion fish | source

set -x EDITOR "code --wait"
set -x SOPS_AGE_KEY_FILE ~/.config/sops/age/keys.txt

{{ if eq .chezmoi.os "darwin" }}
fish_add_path $HOME/.bin/
{{ end }}

fish_add_path $HOME/.krew/bin
fish_add_path $HOME/.cosmo/bin

{{ if eq .chezmoi.os "darwin" }}
for file in ~/.config/fish/functions/work/*.fish
    source $file
end
alias tailscale="/Applications/Tailscale.app/Contents/MacOS/Tailscale"
{{ end }}

{{ if eq .chezmoi.os "linux" }}

for file in ~/.config/fish/functions/personal/*.fish
    source $file
end
{{ end }}

if test -n "$GITLAB_TOKEN" -a -n "$GITHUB_TOKEN"
  load_tokens
end

alias gsi="git submodule update --init --recursive"

function set_go_variables
    set go_env_output (go env)
    for line in $go_env_output
        set -l key (echo $line | awk -F'=' '{print $1}' | tr -d '"')
        set -l value (echo $line | awk -F'=' '{print $2}' | tr -d '"')
        switch $key
            case "GOPATH"
                set -gx GOPATH $value
            case "GOBIN"
                set -gx GOBIN $value
            # Add more cases for other variables if needed
        end
    end
    fish_add_path $GOBIN
end

if status --is-interactive
    set_go_variables
end
